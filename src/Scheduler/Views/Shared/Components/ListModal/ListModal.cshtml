@{
    IEnumerable<Event> events = (IEnumerable<Event>)this.ViewData["Events"];
    IEnumerable<Team> teams = (IEnumerable<Team>)this.ViewData["Teams"];
    string title = this.ViewData["Title"].ToString();
}

<div class="modal fade" id="listModalPopup" tabindex="-1" aria-hidden="false">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header m-auto">
                <h2 class="text-center">@title</h2>
            </div>
            <div class="modal-body">
                @if (events != null && events.Count() > 0)
                {
                    <table class="table-bordered m-auto text-center">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Start</th>
                                <th>End</th>
                                <th>Location</th>
                                <th>Team 1</th>
                                <th>Team 2</th>
                            </tr>
                        </thead>
                        @{
                            foreach (Event e in events)
                            {
                                <tr>
                                    <td>@e.Name</td>
                                    <td>@this.Html.DisplayFor(x => e.StartDate)</td>
                                    <td>@this.Html.DisplayFor(x => e.EndDate)</td>
                                    @if (e.IsBlackout) {
                                        <td>Entire Facility</td>
                                    }else
                                    {
                                        <td>@e.Fields.FirstOrDefault().Name</td>
                                    }
                                    @if (e is Game game)
                                    {
                                        Team? homeTeam = teams.FirstOrDefault(t => t.Id == game.HomeTeamId);
                                        Team? awayTeam = teams.FirstOrDefault(t => t.Id == game.OpposingTeamId);
                                        <td>@homeTeam.Name</td>
                                        <td>@awayTeam.Name</td>
                                    }
                                    else if (e is Practice practice)
                                    {
                                        Team? homeTeam = teams.FirstOrDefault(t => t.Id == practice.TeamId);
                                        <td>@homeTeam.Name</td>
                                        <td class="bg-secondary"></td>
                                    }
                                    else
                                    {
                                        <td class="bg-secondary"></td>
                                        <td class="bg-secondary"></td>
                                    }
                                </tr>
                            }
                        }
                    </table>
                }
                else
                {
                    <p>No Events found.</p>
                }
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<script>
    $(document).ready(function (){
        $("#listModalPopup").modal("show");
    })
</script>